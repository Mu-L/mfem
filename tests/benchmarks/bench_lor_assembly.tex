% ./bench_lor_assembly --benchmark_context=device=cuda --benchmark_filter=AllBatched --benchmark_out_format=csv --benchmark_out=bench_lor_assembly.org
% xelatex -file-line-error -shell-escape -interaction nonstopmode -halt-on-error bench_lor_assembly.tex
\documentclass[tikz]{standalone}
%\documentclass[preview, border=4mm, convert={density=600,outext=.png}]{standalone}
\usepackage{pgfplots}
\pgfplotsset{compat=newest, table/col sep=comma}
\usepackage{tikzscale}
\usetikzlibrary{backgrounds}
\usetikzlibrary{calc}

\newcommand{\DATA}{bench_lor_assembly.org}
\newcommand{\SKIP}{skip 11 }

\newcommand{\TITLE}{LOR Assembly on 1x Tesla V100-SXM2}
\newcommand{\SCALE}{2.0}

\newcommand{\XMIN}{8e2}
\newcommand{\XMAX}{4e6}

\newcommand{\YMIN}{0}
\newcommand{\YMAX}{20}

\newcommand{\SMOOTH}{smooth sbezier}

\usepackage{bm}
\usepackage{times}
\usepackage{fontspec}
\setmainfont{Calibri}

\definecolor{RGB1}{RGB}{31,120,180}  % Dark blue
\definecolor{RGB2}{RGB}{255,127,0}   % Dark orange
\definecolor{RGB3}{RGB}{51,160,44}   % Dark green
\definecolor{RGB4}{RGB}{227,26,28}   % Dark red
\definecolor{RGB5}{RGB}{160,60,140}  % Dark purple (modified)
\definecolor{RGB6}{RGB}{177,89,40}   % Dark brown
\definecolor{RGB7}{RGB}{192,220,192} % Light green
\definecolor{RGB8}{RGB}{220,220,220} % Dark gray

\definecolor{firebrick}{HTML}{B22222}
\definecolor{steelblue4}{HTML}{3B77AF}

\pgfplotsset{tick scale binop=\times}

\pgfplotsset{every axis/.append style={
axis line style={->},
label style={font=\Large},
tick label style={font=\large},
title style={font=\Large\bfseries, text=steelblue4}
}}

\begin{document}
\pgfplotscreateplotcyclelist{CycleList}{%
RGB1!50!black,every mark/.append style={fill=RGB1},mark=*,mark size=2pt\\%
RGB2!50!black,every mark/.append style={fill=RGB2},mark=*,mark size=2pt\\%
RGB3!50!black,every mark/.append style={fill=RGB3},mark=*,smooth,mark size=2pt\\%
RGB4!50!black,every mark/.append style={fill=RGB4},mark=*,smooth,mark size=2pt\\%
RGB5!50!black,every mark/.append style={fill=RGB5},mark=*,smooth,mark size=2pt\\%
RGB6!50!black,every mark/.append style={fill=RGB6},mark=*,smooth,mark size=2pt\\%
RGB7!50!black,every mark/.append style={fill=RGB7},mark=*,smooth,mark size=2pt\\%
RGB8!50!black,every mark/.append style={fill=RGB8},mark=*,smooth,mark size=2pt\\%
}

\begin{tikzpicture}[background rectangle/.style={fill=white},
show background rectangle, scale=\SCALE]
\begin{semilogxaxis}[
    grid=both,
    major grid style={line width=.1pt,draw=gray!50},
    minor grid style={line width=.1pt,draw=gray!50},
    width=4in,
    height=4in,
    xlabel={Degrees of Freedom (DOF)},
    xlabel style={at={(axis description cs:0.5,-0.075)}},
    ylabel={MDOF/s},
    ylabel style={at={(axis description cs:-0.075,0.5)}},
    cycle list name=CycleList,
    %legend cell align=left,
    legend pos=north west,
    legend entries={$p=1$,$p=2$,$p=3$,$p=4$,$p=5$,$p=6$,$p=7$,$p=8$},
    title=\TITLE,
    ymin=\YMIN,
    ymax=\YMAX,
    xmin=\XMIN,
    xmax=\XMAX
  ]

\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==1?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==2?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==3?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==4?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==5?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==6?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==7?$11:NaN) \SMOOTH};
\addplot +[raw gnuplot] gnuplot { set datafile separator ','; plot "\DATA" \SKIP using ($12):($13==8?$11:NaN) \SMOOTH};

\end{semilogxaxis}
\end{tikzpicture}
\end{document}
