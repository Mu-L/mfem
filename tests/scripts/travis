#!/bin/bash

####
# If in travis context we need to checkout a branch, otherwise travis works in detached head.
if ! git checkout -b travis_tests
then
    err "failed to create a branch"
    exit 1
fi

####
msg "Check presence of binary files in branch history."

binary_files=$(tests/scripts/branch_adds_binary)

if [[ $? == "1" ]]
then
    msg "Binary files found : ${binary_files}"
    err "ATTENTION: One or more added/modified binary file(s)"
    exit 1
fi

function msg() {
    echo "travis_tests: $*"
}

function err() {
    echo "travis_tests: $*" 1>&2
}
####
# TODO: Code style checks
