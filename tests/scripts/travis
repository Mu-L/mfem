#!/bin/bash

. tests/scripts/history_checks.bash

####
# If in travis context we need to checkout a branch, otherwise travis works in detached head.
if ! git checkout -b travis_tests
then
    err "failed to create a branch"
    exit 1
fi

####
msg "Check presence of binary files in branch history."

# Read: "if check_bin_in_branch fails"
if ! check_bin_in_branch
then
    err "ATTENTION: One or more added/modified binary file(s)"
    exit 1
fi

function msg() {
    echo "travis_tests: $*"
}

function err() {
    echo "travis_tests: $*" 1>&2
}
####
# TODO: Code style checks
